Originally from @JD:
https://gist.github.com/johnd0e/5110ddfb3291928a7f484cd38f23ff87/
.. with @Xer0X improvement
